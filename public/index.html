<!DOCTYPE html>
<html>

<head>
  <title>Welcome to the Fruit Selector</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
</head>

<body>
  <v-app id="app">
    <v-main>
      <v-btn v-for="colour in teamColour" :color="colour" @click="getTeam(colour)">Get {{ colour }} Team</v-btn>
      <p>Results: {{ results }}</p>
      <p>Elapsed Time: {{ elapsedTime }}</p>

      <v-btn color="primary" @click="flushCache">Clear Cache</v-btn>

    </v-main>

  </v-app>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>

  <script>
    // Vue.js app to coordinate collection of chosen fruit and to handle
    // the 'Save Fruit' button press
    var app = new Vue({
      el: '#app',
      vuetify: new Vuetify(),
      data: {
        teamColour: ["red", "orange", "green", "blue", "yellow", "purple"],
        results: null,
        elapsedTime: 0
      },
      methods: {
        flushCache: async function () {
          // calculate the URL of the server-side process
          const url = window.location.origin + '/flush'

          // try posting to the /flush endpoint try {
          const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' }
          });
          const data = await response.json();
          

        },
        getTeam: async function (colour) {
          // calculate the URL of the server-side process
          const url = window.location.origin + '/team'

          // try posting to the /team endpoint to fetch data
          try {
            const before = new Date().getTime()
            const response = await fetch(url, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ team: colour })
            });
            const data = await response.json();
            const after = new Date().getTime()
            this.elapsedTime = after - before
            this.results = data
            console.log(data)
          } catch (error) {
            // enter your logic for when there is an error (ex. error toast)
            console.log(error)
          }
        }
      }
    })
  </script>
</body>

</html>